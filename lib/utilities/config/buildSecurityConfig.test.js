const buildSecurityConfig=require(./buildSecurityConfig);describe('buildSecurityConfig',()=>{it('should build config with defaults',()=>{const config=buildSecurityConfig();expect(config.encryption.enabled).toBe(true);expect(config.encryption.algorithm).toBe('aes-256-gcm');expect(config.hash.algorithm).toBe('sha256');expect(config.authentication.sessionTimeout).toBe(30*60*1000);expect(config.authentication.maxLoginAttempts).toBe(5);expect(config.authentication.passwordPolicy.minLength).toBe(8);expect(config.jwt.expiration).toBe('1h');expect(config.cors.origins).toEqual(['*']);expect(config.rateLimit.enabled).toBe(true);expect(config.rateLimit.max).toBe(100);expect(config.headers['X-Frame-Options']).toBe('DENY')});it('should validate session timeout',()=>{expect(()=>buildSecurityConfig({sessionTimeout: 0})).toThrow('Session timeout must be positive');expect(()=>buildSecurityConfig({sessionTimeout: -1000})).toThrow('Session timeout must be positive')});it('should validate max login attempts',()=>{expect(()=>buildSecurityConfig({maxLoginAttempts: 0})).toThrow('Max login attempts must be positive')});it('should validate password min length',()=>{expect(()=>buildSecurityConfig({passwordMinLength: 3})).toThrow('Password minimum length must be at least 4')});it('should build config with custom values',()=>{const config=buildSecurityConfig({encryptionEnabled: false,encryptionAlgorithm: 'aes-128-cbc',sessionTimeout: 60*60*1000,maxLoginAttempts: 3,passwordMinLength: 12,jwtSecret: 'my-secret',jwtExpiration: '24h',corsOrigins: ['https://example.com'],rateLimitMax: 1000});expect(config.encryption.enabled).toBe(false);expect(config.encryption.algorithm).toBe('aes-128-cbc');expect(config.authentication.sessionTimeout).toBe(60*60*1000);expect(config.authentication.maxLoginAttempts).toBe(3);expect(config.authentication.passwordPolicy.minLength).toBe(12);expect(config.jwt.secret).toBe('my-secret');expect(config.jwt.expiration).toBe('24h');expect(config.cors.origins).toEqual(['https://example.com']);expect(config.rateLimit.max).toBe(1000)});it('should handle string corsOrigins',()=>{const config=buildSecurityConfig({corsOrigins: 'https://single.com'});expect(config.cors.origins).toEqual(['https://single.com'])});it('should include all security header options',()=>{const config=buildSecurityConfig({securityHeadersEnabled: true,httpsRedirect: true,trustProxy: true});expect(config.securityHeadersEnabled).toBe(true);expect(config.httpsRedirect).toBe(true);expect(config.trustProxy).toBe(true)})});