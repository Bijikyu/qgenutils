'use strict';const getPerformanceHealthStatus=require(./getPerformanceHealthStatus);describe('getPerformanceHealthStatus',()=>{const mockMetrics ={eventLoopLag: 5,cpuUsage: 30,heapUsedPercent: 40,responseTime: 100,throughput: 50};it('should throw for invalid metrics',()=>{expect(()=>getPerformanceHealthStatus(null)).toThrow('Metrics must be an object');expect(()=>getPerformanceHealthStatus('string')).toThrow('Metrics must be an object')});it('should throw for invalid alerts',()=>expect(()=>getPerformanceHealthStatus(mockMetrics,'not-array')).toThrow('Alerts must be an array'));it('should return healthy status with no alerts',()=>{const result=getPerformanceHealthStatus(mockMetrics,[]);expect(result.status).toBe('healthy');expect(result.recommendations).toContain('Performance is within acceptable thresholds')});it('should return warning status with warning alerts',()=>{const alerts =[{severity: 'warning',type: 'response_time'}],result=getPerformanceHealthStatus(mockMetrics,alerts);expect(result.status).toBe('warning');expect(result.recommendations).toContain('Monitor performance closely')});it('should return critical status with critical alerts',()=>{const alerts =[{severity: 'critical',type: 'memory'}],result=getPerformanceHealthStatus(mockMetrics,alerts);expect(result.status).toBe('critical');expect(result.recommendations).toContain('Immediate performance optimization required')});it('should include memory-specific recommendations',()=>{const alerts =[{severity: 'critical',type: 'memory'}],result=getPerformanceHealthStatus(mockMetrics,alerts);expect(result.recommendations.some(r =>r.includes('memory'))).toBe(true)});it('should include CPU-specific recommendations',()=>{const alerts =[{severity: 'critical',type: 'cpu'}],result=getPerformanceHealthStatus(mockMetrics,alerts);expect(result.recommendations.some(r =>r.includes('CPU'))).toBe(true)});it('should include event loop recommendations',()=>{const alerts =[{severity: 'critical',type: 'event_loop'}],result=getPerformanceHealthStatus(mockMetrics,alerts);expect(result.recommendations.some(r =>r.includes('Event loop'))).toBe(true)});it('should limit alerts to specified limit',()=>{const alerts=Array(20).fill({severity: 'warning',type: 'response_time'}),result=getPerformanceHealthStatus(mockMetrics,alerts,5);expect(result.alerts.length).toBe(5)});it('should return all expected fields',()=>{const result=getPerformanceHealthStatus(mockMetrics,[]);expect(result).toHaveProperty('status');expect(result).toHaveProperty('metrics');expect(result).toHaveProperty('alerts');expect(result).toHaveProperty('recommendations')});it('should not mutate original metrics',()=>{const original ={...mockMetrics},result=getPerformanceHealthStatus(mockMetrics,[]);result.metrics.cpuUsage=999;expect(mockMetrics.cpuUsage).toBe(original.cpuUsage)})});