500e19dccc6096bae2621b3e66bf257b
const {
  default: timingSafeCompare
} = require('./timingSafeCompare');
describe('timingSafeCompare', () => {
  it('should return true for equal strings', () => {
    expect(timingSafeCompare('secret123', 'secret123')).toBe(true);
    expect(timingSafeCompare('', '')).toBe(true);
    expect(timingSafeCompare('a', 'a')).toBe(true);
  });
  it('should return false for different strings', () => {
    expect(timingSafeCompare('secret123', 'secret124')).toBe(false);
    expect(timingSafeCompare('abc', 'abd')).toBe(false);
  });
  it('should return false for different lengths', () => {
    expect(timingSafeCompare('short', 'longer')).toBe(false);
    expect(timingSafeCompare('abc', 'ab')).toBe(false);
  });
  it('should return false for non-string inputs', () => {
    expect(timingSafeCompare(null, 'test')).toBe(false);
    expect(timingSafeCompare('test', null)).toBe(false);
    expect(timingSafeCompare(123, '123')).toBe(false);
    expect(timingSafeCompare(undefined, undefined)).toBe(false);
  });
  it('should handle special characters', () => {
    expect(timingSafeCompare('test!@#$%', 'test!@#$%')).toBe(true);
    expect(timingSafeCompare('key=abc&token=xyz', 'key=abc&token=xyz')).toBe(true);
  });
  it('should handle unicode strings', () => {
    expect(timingSafeCompare('héllo', 'héllo')).toBe(true);
    expect(timingSafeCompare('日本語', '日本語')).toBe(true);
    expect(timingSafeCompare('héllo', 'hello')).toBe(false);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkZWZhdWx0IiwidGltaW5nU2FmZUNvbXBhcmUiLCJyZXF1aXJlIiwiZGVzY3JpYmUiLCJpdCIsImV4cGVjdCIsInRvQmUiLCJ1bmRlZmluZWQiXSwic291cmNlcyI6WyJ0aW1pbmdTYWZlQ29tcGFyZS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZGVmYXVsdDogdGltaW5nU2FmZUNvbXBhcmUgfSA9IHJlcXVpcmUoJy4vdGltaW5nU2FmZUNvbXBhcmUnKTtcblxuZGVzY3JpYmUoJ3RpbWluZ1NhZmVDb21wYXJlJywgKCkgPT4ge1xuICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIGZvciBlcXVhbCBzdHJpbmdzJywgKCkgPT4ge1xuICAgIGV4cGVjdCh0aW1pbmdTYWZlQ29tcGFyZSgnc2VjcmV0MTIzJywgJ3NlY3JldDEyMycpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdCh0aW1pbmdTYWZlQ29tcGFyZSgnJywgJycpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdCh0aW1pbmdTYWZlQ29tcGFyZSgnYScsICdhJykpLnRvQmUodHJ1ZSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGZvciBkaWZmZXJlbnQgc3RyaW5ncycsICgpID0+IHtcbiAgICBleHBlY3QodGltaW5nU2FmZUNvbXBhcmUoJ3NlY3JldDEyMycsICdzZWNyZXQxMjQnKSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHRpbWluZ1NhZmVDb21wYXJlKCdhYmMnLCAnYWJkJykpLnRvQmUoZmFsc2UpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSBmb3IgZGlmZmVyZW50IGxlbmd0aHMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KHRpbWluZ1NhZmVDb21wYXJlKCdzaG9ydCcsICdsb25nZXInKSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHRpbWluZ1NhZmVDb21wYXJlKCdhYmMnLCAnYWInKSkudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGZvciBub24tc3RyaW5nIGlucHV0cycsICgpID0+IHtcbiAgICBleHBlY3QodGltaW5nU2FmZUNvbXBhcmUobnVsbCwgJ3Rlc3QnKSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHRpbWluZ1NhZmVDb21wYXJlKCd0ZXN0JywgbnVsbCkpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdCh0aW1pbmdTYWZlQ29tcGFyZSgxMjMsICcxMjMnKSkudG9CZShmYWxzZSk7XG4gICAgZXhwZWN0KHRpbWluZ1NhZmVDb21wYXJlKHVuZGVmaW5lZCwgdW5kZWZpbmVkKSkudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaGFuZGxlIHNwZWNpYWwgY2hhcmFjdGVycycsICgpID0+IHtcbiAgICBleHBlY3QodGltaW5nU2FmZUNvbXBhcmUoJ3Rlc3QhQCMkJScsICd0ZXN0IUAjJCUnKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QodGltaW5nU2FmZUNvbXBhcmUoJ2tleT1hYmMmdG9rZW49eHl6JywgJ2tleT1hYmMmdG9rZW49eHl6JykpLnRvQmUodHJ1ZSk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaGFuZGxlIHVuaWNvZGUgc3RyaW5ncycsICgpID0+IHtcbiAgICBleHBlY3QodGltaW5nU2FmZUNvbXBhcmUoJ2jDqWxsbycsICdow6lsbG8nKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QodGltaW5nU2FmZUNvbXBhcmUoJ+aXpeacrOiqnicsICfml6XmnKzoqp4nKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QodGltaW5nU2FmZUNvbXBhcmUoJ2jDqWxsbycsICdoZWxsbycpKS50b0JlKGZhbHNlKTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTTtFQUFFQSxPQUFPLEVBQUVDO0FBQWtCLENBQUMsR0FBR0MsT0FBTyxDQUFDLHFCQUFxQixDQUFDO0FBRXJFQyxRQUFRLENBQUMsbUJBQW1CLEVBQUUsTUFBTTtFQUNsQ0MsRUFBRSxD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