2d75b888b27a19b6c3ba7ef215ba3b8e
/**
 * Integration Tests for QGenUtils Core Functionality
 * 
 * Tests real-world usage scenarios and integration between utilities
 */

import { validateEmail, hashPassword, verifyPassword, memoize, debounce, formatDateTime, ensureProtocol, formatFileSize, createApiKeyValidator, createRateLimiter } from '../../dist/index-core.js';
describe('QGenUtils Integration Tests', () => {
  describe('Authentication Flow Integration', () => {
    test('should validate email, hash password, and verify', async () => {
      const email = 'test@example.com';
      const password = 'SecurePassword123!';

      // Step 1: Validate email
      expect(validateEmail(email)).toBe(true);
      expect(validateEmail('invalid-email')).toBe(false);

      // Step 2: Hash password
      const hashedPassword = await hashPassword(password);
      expect(hashedPassword).toBeDefined();
      expect(hashedPassword).not.toBe(password);
      expect(hashedPassword.length).toBeGreaterThan(50);

      // Step 3: Verify password
      const isValid = await verifyPassword(password, hashedPassword);
      expect(isValid).toBe(true);
      const isInvalid = await verifyPassword('wrongpassword', hashedPassword);
      expect(isInvalid).toBe(false);
    }, 10000);
  });
  describe('Performance Optimization Integration', () => {
    test('should optimize expensive operations with memoization', async () => {
      let callCount = 0;
      const expensiveFunction = memoize(input => {
        callCount++;
        // Simulate expensive operation
        const result = input * 2;
        return new Promise(resolve => {
          setTimeout(() => resolve(result), 10);
        });
      });

      // First call should compute
      const result1 = await expensiveFunction(21);
      expect(result1).toBe(42);
      expect(callCount).toBe(1);

      // Second call should use cache
      const result2 = await expensiveFunction(21);
      expect(result2).toBe(42);
      expect(callCount).toBe(1); // Should not increment

      // Different input should compute
      const result3 = await expensiveFunction(30);
      expect(result3).toBe(60);
      expect(callCount).toBe(2);
    }, 15000);
    test('should debounce rapid function calls', async () => {
      let callCount = 0;
      let lastValue = null;
      const debouncedFunction = debounce(value => {
        callCount++;
        lastValue = value;
      }, 100);

      // Rapid calls should be debounced
      debouncedFunction('value1');
      debouncedFunction('value2');
      debouncedFunction('value3');

      // Should not execute immediately
      expect(callCount).toBe(0);
      expect(lastValue).toBe(null);

      // Wait for debounce
      await new Promise(resolve => setTimeout(resolve, 150));

      // Should execute only once with last value
      expect(callCount).toBe(1);
      expect(lastValue).toBe('value3');
    }, 5000);
  });
  describe('DateTime Integration', () => {
    test('should format dates consistently across utilities', () => {
      const testDate = new Date('2023-12-25T10:30:00.000Z');
      const formatted = formatDateTime(testDate);
      expect(formatted.original).toBe(testDate);
      expect(formatted.formatted).toBeDefined();
      expect(formatted.timestamp).toBe(testDate.getTime());
      expect(formatted.error).toBeUndefined();

      // Test with invalid date
      const invalidResult = formatDateTime('invalid-date');
      expect(invalidResult.error).toBeDefined();
      expect(invalidResult.error).toContain('Invalid date');
    }, 5000);
  });
  describe('URL Processing Integration', () => {
    test('should handle URL protocol operations correctly', () => {
      const testCases = [{
        input: 'example.com',
        expected: {
          processed: 'https://example.com',
          added: true
        }
      }, {
        input: 'https://example.com',
        expected: {
          processed: 'https://example.com',
          added: false
        }
      }, {
        input: 'ftp://files.example.com',
        expected: {
          processed: 'ftp://files.example.com',
          added: false
        }
      }];
      testCases.forEach(({
        input,
        expected
      }) => {
        const result = ensureProtocol(input);
        expect(result.processed).toBe(expected.processed);
        expect(result.added).toBe(expected.added);
      });
    }, 5000);
  });
  describe('File Operations Integration', () => {
    test('should format file sizes across different scales', () => {
      const testCases = [{
        input: 1024,
        expectedUnit: 'KB'
      }, {
        input: 1048576,
        expectedUnit: 'MB'
      }, {
        input: 1073741824,
        expectedUnit: 'GB'
      }, {
        input: 1099511627776,
        expectedUnit: 'TB'
      }];
      testCases.forEach(({
        input,
        expectedUnit
      }) => {
        const result = formatFileSize(input);
        expect(result.bytes).toBe(input);
        expect(result.unit).toBe(expectedUnit);
        expect(result.size).toBeGreaterThan(0);
        expect(result.formatted).toMatch(/\d+\.\d+ [KMGT]B/);
      });
    }, 5000);
  });
  describe('Middleware Integration', () => {
    test('should create and test API key validator', () => {
      const testApiKey = 'test-api-key-12345';
      const validator = createApiKeyValidator({
        apiKey: testApiKey
      });

      // Mock Express request/response
      const req = {
        headers: {
          'x-api-key': testApiKey
        }
      };
      const res = {
        status: jest.fn().mockReturnThis(),
        json: jest.fn().mockReturnThis()
      };
      const next = jest.fn();

      // Valid API key should pass
      validator(req, res, next);
      expect(next).toHaveBeenCalled();
      expect(req.validatedApiKey).toBe(testApiKey);
      expect(res.status).not.toHaveBeenCalledWith(401);
    }, 5000);
    test('should create and test rate limiter', async () => {
      const limiter = createRateLimiter({
        windowMs: 60000,
        // 1 minute
        maxRequests: 5
      });

      // Mock Express request/response
      const req = {
        ip: '192.168.1.1',
        headers: {},
        app: {
          get: jest.fn().mockReturnValue(false)
        }
      };
      const res = {
        statusCode: 200
      };
      res.status = jest.fn(code => {
        res.statusCode = code;
        return res;
      });
      res.json = jest.fn().mockReturnThis();
      res.send = jest.fn().mockReturnThis();
      res.setHeader = jest.fn();
      res.headersSent = false;
      res.writableEnded = false;
      const next = jest.fn();

      // First 5 requests should pass
      for (let i = 0; i < 5; i++) {
        await limiter(req, res, next);
        expect(next).toHaveBeenCalledTimes(1);
        next.mockClear(); // reset for next iteration
      }

      // 6th request should be rate limited
      await limiter(req, res, next);
      expect(res.status).toHaveBeenCalledWith(429);
      expect(next).not.toHaveBeenCalled();
    }, 5000);
  });
  describe('Error Handling Integration', () => {
    test('should handle validation errors gracefully', () => {
      expect(() => {
        validateEmail(null);
      }).not.toThrow(); // Should not throw, return false

      expect(() => {
        formatFileSize(-1);
      }).not.toThrow(); // Should return error object

      expect(() => {
        formatDateTime('invalid-date');
      }).not.toThrow(); // Should return error object
    }, 5000);
    test('should handle edge cases', () => {
      // Edge cases for validation
      expect(validateEmail('')).toBe(false);
      expect(validateEmail('a@b')).toBe(true); // Minimal valid

      // Edge cases for file size
      expect(formatFileSize(0)).toEqual({
        bytes: 0,
        formatted: '0 B',
        unit: 'B',
        size: 0,
        unitIndex: 0
      });

      // Edge cases for URL
      expect(ensureProtocol('').original).toBe('');
    }, 5000);
  });
  describe('Performance Metrics Integration', () => {
    test('should measure performance across utilities', async () => {
      const startTime = performance.now();

      // Run multiple utilities
      const emailValid = validateEmail('test@example.com');
      const urlFixed = ensureProtocol('example.com');
      const fileSize = formatFileSize(1048576);
      const dateFormatted = formatDateTime(new Date());
      const endTime = performance.now();
      const duration = endTime - startTime;

      // All should work correctly
      expect(emailValid).toBe(true);
      expect(urlFixed.added).toBe(true);
      expect(fileSize.unit).toBe('MB');
      expect(dateFormatted.formatted).toBeDefined();

      // Should complete in reasonable time
      expect(duration).toBeLessThan(100); // 100ms max
    }, 5000);
  });
  describe('Memory Efficiency Integration', () => {
    test('should handle large data operations efficiently', async () => {
      const largeDataset = Array.from({
        length: 1000
      }, (_, i) => ({
        id: i,
        email: `user${i}@example.com`,
        data: `Lorem ipsum dolor sit amet ${i}`.repeat(10)
      }));

      // Process large dataset with memoization
      let processedCount = 0;
      const processUser = memoize(user => {
        processedCount++;
        return {
          ...user,
          isValid: validateEmail(user.email),
          processedAt: Date.now()
        };
      });

      // Process all users
      const results = largeDataset.map(processUser);
      expect(results).toHaveLength(1000);
      expect(processedCount).toBe(1000); // Each unique user processed once

      // Process same dataset again (should use cache)
      const cachedResults = largeDataset.map(processUser);
      expect(cachedResults).toHaveLength(1000);
      expect(processedCount).toBe(1000); // No additional processing
    }, 20000);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2YWxpZGF0ZUVtYWlsIiwiaGFzaFBhc3N3b3JkIiwidmVyaWZ5UGFzc3dvcmQiLCJtZW1vaXplIiwiZGVib3VuY2UiLCJmb3JtYXREYXRlVGltZSIsImVuc3VyZVByb3RvY29sIiwiZm9ybWF0RmlsZVNpemUiLCJjcmVhdGVBcGlLZXlWYWxpZGF0b3IiLCJjcmVhdGVSYXRlTGltaXRlciIsImRlc2NyaWJlIiwidGVzdCIsImVtYWlsIiwicGFzc3dvcmQiLCJleHBlY3QiLCJ0b0JlIiwiaGFzaGVkUGFzc3dvcmQiLCJ0b0JlRGVmaW5lZCIsIm5vdCIsImxlbmd0aCIsInRvQmVHcmVhdGVyVGhhbiIsImlzVmFsaWQiLCJpc0ludmFsaWQiLCJjYWxsQ291bnQiLCJleHBlbnNpdmVGdW5jdGlvbiIsImlucHV0IiwicmVzdWx0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwicmVzdWx0MSIsInJlc3VsdDIiLCJyZXN1bHQzIiwibGFzdFZhbHVlIiwiZGVib3VuY2VkRnVuY3Rpb24iLCJ2YWx1ZSIsInRlc3REYXRlIiwiRGF0ZSIsImZvcm1hdHRlZCIsIm9yaWdpbmFsIiwidGltZXN0YW1wIiwiZ2V0VGltZSIsImVycm9yIiwidG9CZVVuZGVmaW5lZCIsImludmFsaWRSZXN1bHQiLCJ0b0NvbnRhaW4iLCJ0ZXN0Q2FzZXMiLCJleHBlY3RlZCIsInByb2Nlc3NlZCIsImFkZGVkIiwiZm9yRWFjaCIsImV4cGVjdGVkVW5pdCIsImJ5dGVzIiwidW5pdCIsInNpemUiLCJ0b01hdGNoIiwidGVzdEFwaUtleSIsInZhbGlkYXRvciIsImFwaUtleSIsInJlcSIsImhlYWRlcnMiLCJyZXMiLCJzdGF0dXMiLCJqZXN0IiwiZm4iLCJtb2NrUmV0dXJuVGhpcyIsImpzb24iLCJuZXh0IiwidG9IYXZlQmVlbkNhbGxlZCIsInZhbGlkYXRlZEFwaUtleSIsInRvSGF2ZUJlZW5DYWxsZWRXaXRoIiwibGltaXRlciIsIndpbmRvd01zIiwibWF4UmVxdWVzdHMiLCJpcCIsImFwcCIsImdldCIsIm1vY2tSZXR1cm5WYWx1ZSIsInN0YXR1c0NvZGUiLCJjb2RlIiwic2VuZCIsInNldEhlYWRlciIsImhlYWRlcnNTZW50Iiwid3JpdGFibGVFbmRlZCIsImkiLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJtb2NrQ2xlYXIiLCJ0b1Rocm93IiwidG9FcXVhbCIsInVuaXRJbmRleCIsInN0YXJ0VGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwiZW1haWxWYWxpZCIsInVybEZpeGVkIiwiZmlsZVNpemUiLCJkYXRlRm9ybWF0dGVkIiwiZW5kVGltZSIsImR1cmF0aW9uIiwidG9CZUxlc3NUaGFuIiwibGFyZ2VEYXRhc2V0IiwiQXJyYXkiLCJmcm9tIiwiXyIsImlkIiwiZGF0YSIsInJlcGVhdCIsInByb2Nlc3NlZENvdW50IiwicHJvY2Vzc1VzZXIiLCJ1c2VyIiwicHJvY2Vzc2VkQXQiLCJyZXN1bHRzIiwibWFwIiwidG9IYXZlTGVuZ3RoIiwiY2FjaGVkUmVzdWx0cyJdLCJzb3VyY2VzIjpbImNvcmUtZnVuY3Rpb25hbGl0eS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW50ZWdyYXRpb24gVGVzdHMgZm9yIFFHZW5VdGlscyBDb3JlIEZ1bmN0aW9uYWxpdHlcbiAqIFxuICogVGVzdHMgcmVhbC13b3JsZCB1c2FnZSBzY2VuYXJpb3MgYW5kIGludGVncmF0aW9uIGJldHdlZW4gdXRpbGl0aWVzXG4gKi9cblxuaW1wb3J0IHsgXG4gIHZhbGlkYXRlRW1haWwsXG4gIGhhc2hQYXNzd29yZCxcbiAgdmVyaWZ5UGFzc3dvcmQsXG4gIG1lbW9pemUsXG4gIGRlYm91bmNlLFxuICBmb3JtYXREYXRlVGltZSxcbiAgZW5zdXJlUHJvdG9jb2wsXG4gIGZvcm1hdEZpbGVTaXplLFxuICBjcmVhdGVBcGlLZXlWYWxpZGF0b3IsXG4gIGNyZWF0ZVJhdGVMaW1pdGVyXG59IGZyb20gJy4uLy4uL2Rpc3QvaW5kZXgtY29yZS5qcyc7XG5cbmRlc2NyaWJlKCdRR2VuVXRpbHMgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdBdXRoZW50aWNhdGlvbiBGbG93IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCB2YWxpZGF0ZSBlbWFpbCwgaGFzaCBwYXNzd29yZCwgYW5kIHZlcmlmeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGVtYWlsID0gJ3Rlc3RAZXhhbXBsZS5jb20nO1xuICAgICAgY29uc3QgcGFzc3dvcmQgPSAnU2VjdXJlUGFzc3dvcmQxMjMhJztcbiAgICAgIFxuICAgICAgLy8gU3RlcCAxOiBWYWxpZGF0ZSBlbWFpbFxuICAgICAgZXhwZWN0KHZhbGlkYXRlRW1haWwoZW1haWwpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHZhbGlkYXRlRW1haWwoJ2ludmFsaWQtZW1haWwnKSkudG9CZShmYWxzZSk7XG4gICAgICBcbiAgICAgIC8vIFN0ZXAgMjogSGFzaCBwYXNzd29yZFxuICAgICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBoYXNoUGFzc3dvcmQocGFzc3dvcmQpO1xuICAgICAgZXhwZWN0KGhhc2hlZFBhc3N3b3JkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGhhc2hlZFBhc3N3b3JkKS5ub3QudG9CZShwYXNzd29yZCk7XG4gICAgICBleHBlY3QoaGFzaGVkUGFzc3dvcmQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oNTApO1xuICAgICAgXG4gICAgICAvLyBTdGVwIDM6IFZlcmlmeSBwYXNzd29yZFxuICAgICAgY29uc3QgaXNWYWxpZCA9IGF3YWl0IHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZCk7XG4gICAgICBleHBlY3QoaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIFxuICAgICAgY29uc3QgaXNJbnZhbGlkID0gYXdhaXQgdmVyaWZ5UGFzc3dvcmQoJ3dyb25ncGFzc3dvcmQnLCBoYXNoZWRQYXNzd29yZCk7XG4gICAgICBleHBlY3QoaXNJbnZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICB9LCAxMDAwMCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQZXJmb3JtYW5jZSBPcHRpbWl6YXRpb24gSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIG9wdGltaXplIGV4cGVuc2l2ZSBvcGVyYXRpb25zIHdpdGggbWVtb2l6YXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgY2FsbENvdW50ID0gMDtcbiAgICAgIFxuICAgICAgY29uc3QgZXhwZW5zaXZlRnVuY3Rpb24gPSBtZW1vaXplKChpbnB1dCkgPT4ge1xuICAgICAgICBjYWxsQ291bnQrKztcbiAgICAgICAgLy8gU2ltdWxhdGUgZXhwZW5zaXZlIG9wZXJhdGlvblxuICAgICAgICBjb25zdCByZXN1bHQgPSBpbnB1dCAqIDI7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlc29sdmUocmVzdWx0KSwgMTApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBGaXJzdCBjYWxsIHNob3VsZCBjb21wdXRlXG4gICAgICBjb25zdCByZXN1bHQxID0gYXdhaXQgZXhwZW5zaXZlRnVuY3Rpb24oMjEpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEpLnRvQmUoNDIpO1xuICAgICAgZXhwZWN0KGNhbGxDb3VudCkudG9CZSgxKTtcbiAgICAgIFxuICAgICAgLy8gU2Vjb25kIGNhbGwgc2hvdWxkIHVzZSBjYWNoZVxuICAgICAgY29uc3QgcmVzdWx0MiA9IGF3YWl0IGV4cGVuc2l2ZUZ1bmN0aW9uKDIxKTtcbiAgICAgIGV4cGVjdChyZXN1bHQyKS50b0JlKDQyKTtcbiAgICAgIGV4cGVjdChjYWxsQ291bnQpLnRvQmUoMSk7IC8vIFNob3VsZCBub3QgaW5jcmVtZW50XG4gICAgICBcbiAgICAgIC8vIERpZmZlcmVudCBpbnB1dCBzaG91bGQgY29tcHV0ZVxuICAgICAgY29uc3QgcmVzdWx0MyA9IGF3YWl0IGV4cGVuc2l2ZUZ1bmN0aW9uKDMwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQzKS50b0JlKDYwKTtcbiAgICAgIGV4cGVjdChjYWxsQ291bnQpLnRvQmUoMik7XG4gICAgfSwgMTUwMDApO1xuICAgIFxuICAgIHRlc3QoJ3Nob3VsZCBkZWJvdW5jZSByYXBpZCBmdW5jdGlvbiBjYWxscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBjYWxsQ291bnQgPSAwO1xuICAgICAgbGV0IGxhc3RWYWx1ZSA9IG51bGw7XG4gICAgICBcbiAgICAgIGNvbnN0IGRlYm91bmNlZEZ1bmN0aW9uID0gZGVib3VuY2UoKHZhbHVlKSA9PiB7XG4gICAgICAgIGNhbGxDb3VudCsrO1xuICAgICAgICBsYXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgIH0sIDEwMCk7XG4gICAgICBcbiAgICAgIC8vIFJhcGlkIGNhbGxzIHNob3VsZCBiZSBkZWJvdW5jZWRcbiAgICAgIGRlYm91bmNlZEZ1bmN0aW9uKCd2YWx1ZTEnKTtcbiAgICAgIGRlYm91bmNlZEZ1bmN0aW9uKCd2YWx1ZTInKTtcbiAgICAgIGRlYm91bmNlZEZ1bmN0aW9uKCd2YWx1ZTMnKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIG5vdCBleGVjdXRlIGltbWVkaWF0ZWx5XG4gICAgICBleHBlY3QoY2FsbENvdW50KS50b0JlKDApO1xuICAgICAgZXhwZWN0KGxhc3RWYWx1ZSkudG9CZShudWxsKTtcbiAgICAgIFxuICAgICAgLy8gV2FpdCBmb3IgZGVib3VuY2VcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxNTApKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIGV4ZWN1dGUgb25seSBvbmNlIHdpdGggbGFzdCB2YWx1ZVxuICAgICAgZXhwZWN0KGNhbGxDb3VudCkudG9CZSgxKTtcbiAgICAgIGV4cGVjdChsYXN0VmFsdWUpLnRvQmUoJ3ZhbHVlMycpO1xuICAgIH0sIDUwMDApO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGF0ZVRpbWUgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGZvcm1hdCBkYXRlcyBjb25zaXN0ZW50bHkgYWNyb3NzIHV0aWxpdGllcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3REYXRlID0gbmV3IERhdGUoJzIwMjMtMTItMjVUMTA6MzA6MDAuMDAwWicpO1xuICAgICAgXG4gICAgICBjb25zdCBmb3JtYXR0ZWQgPSBmb3JtYXREYXRlVGltZSh0ZXN0RGF0ZSk7XG4gICAgICBleHBlY3QoZm9ybWF0dGVkLm9yaWdpbmFsKS50b0JlKHRlc3REYXRlKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZWQuZm9ybWF0dGVkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGZvcm1hdHRlZC50aW1lc3RhbXApLnRvQmUodGVzdERhdGUuZ2V0VGltZSgpKTtcbiAgICAgIGV4cGVjdChmb3JtYXR0ZWQuZXJyb3IpLnRvQmVVbmRlZmluZWQoKTtcbiAgICAgIFxuICAgICAgLy8gVGVzdCB3aXRoIGludmFsaWQgZGF0ZVxuICAgICAgY29uc3QgaW52YWxpZFJlc3VsdCA9IGZvcm1hdERhdGVUaW1lKCdpbnZhbGlkLWRhdGUnKTtcbiAgICAgIGV4cGVjdChpbnZhbGlkUmVzdWx0LmVycm9yKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KGludmFsaWRSZXN1bHQuZXJyb3IpLnRvQ29udGFpbignSW52YWxpZCBkYXRlJyk7XG4gICAgfSwgNTAwMCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVUkwgUHJvY2Vzc2luZyBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIFVSTCBwcm90b2NvbCBvcGVyYXRpb25zIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHRlc3RDYXNlcyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlucHV0OiAnZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGV4cGVjdGVkOiB7IHByb2Nlc3NlZDogJ2h0dHBzOi8vZXhhbXBsZS5jb20nLCBhZGRlZDogdHJ1ZSB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpbnB1dDogJ2h0dHBzOi8vZXhhbXBsZS5jb20nLFxuICAgICAgICAgIGV4cGVjdGVkOiB7IHByb2Nlc3NlZDogJ2h0dHBzOi8vZXhhbXBsZS5jb20nLCBhZGRlZDogZmFsc2UgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaW5wdXQ6ICdmdHA6Ly9maWxlcy5leGFtcGxlLmNvbScsXG4gICAgICAgICAgZXhwZWN0ZWQ6IHsgcHJvY2Vzc2VkOiAnZnRwOi8vZmlsZXMuZXhhbXBsZS5jb20nLCBhZGRlZDogZmFsc2UgfVxuICAgICAgICB9XG4gICAgICBdO1xuICAgICAgXG4gICAgICB0ZXN0Q2FzZXMuZm9yRWFjaCgoeyBpbnB1dCwgZXhwZWN0ZWQgfSkgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBlbnN1cmVQcm90b2NvbChpbnB1dCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQucHJvY2Vzc2VkKS50b0JlKGV4cGVjdGVkLnByb2Nlc3NlZCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuYWRkZWQpLnRvQmUoZXhwZWN0ZWQuYWRkZWQpO1xuICAgICAgfSk7XG4gICAgfSwgNTAwMCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdGaWxlIE9wZXJhdGlvbnMgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGZvcm1hdCBmaWxlIHNpemVzIGFjcm9zcyBkaWZmZXJlbnQgc2NhbGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGVzdENhc2VzID0gW1xuICAgICAgICB7IGlucHV0OiAxMDI0LCBleHBlY3RlZFVuaXQ6ICdLQicgfSxcbiAgICAgICAgeyBpbnB1dDogMTA0ODU3NiwgZXhwZWN0ZWRVbml0OiAnTUInIH0sXG4gICAgICAgIHsgaW5wdXQ6IDEwNzM3NDE4MjQsIGV4cGVjdGVkVW5pdDogJ0dCJyB9LFxuICAgICAgICB7IGlucHV0OiAxMDk5NTExNjI3Nzc2LCBleHBlY3RlZFVuaXQ6ICdUQicgfVxuICAgICAgXTtcbiAgICAgIFxuICAgICAgdGVzdENhc2VzLmZvckVhY2goKHsgaW5wdXQsIGV4cGVjdGVkVW5pdCB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGZvcm1hdEZpbGVTaXplKGlucHV0KTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5ieXRlcykudG9CZShpbnB1dCk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQudW5pdCkudG9CZShleHBlY3RlZFVuaXQpO1xuICAgICAgICBleHBlY3QocmVzdWx0LnNpemUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5mb3JtYXR0ZWQpLnRvTWF0Y2goL1xcZCtcXC5cXGQrIFtLTUdUXUIvKTtcbiAgICAgIH0pO1xuICAgIH0sIDUwMDApO1xuICB9KTtcblxuICBkZXNjcmliZSgnTWlkZGxld2FyZSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGFuZCB0ZXN0IEFQSSBrZXkgdmFsaWRhdG9yJywgKCkgPT4ge1xuICAgICAgY29uc3QgdGVzdEFwaUtleSA9ICd0ZXN0LWFwaS1rZXktMTIzNDUnO1xuICAgICAgY29uc3QgdmFsaWRhdG9yID0gY3JlYXRlQXBpS2V5VmFsaWRhdG9yKHsgYXBpS2V5OiB0ZXN0QXBpS2V5IH0pO1xuICAgICAgXG4gICAgICAvLyBNb2NrIEV4cHJlc3MgcmVxdWVzdC9yZXNwb25zZVxuICAgICAgY29uc3QgcmVxID0ge1xuICAgICAgICBoZWFkZXJzOiB7ICd4LWFwaS1rZXknOiB0ZXN0QXBpS2V5IH1cbiAgICAgIH07XG4gICAgICBjb25zdCByZXMgPSB7XG4gICAgICAgIHN0YXR1czogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICAgIGpzb246IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpXG4gICAgICB9O1xuICAgICAgY29uc3QgbmV4dCA9IGplc3QuZm4oKTtcbiAgICAgIFxuICAgICAgLy8gVmFsaWQgQVBJIGtleSBzaG91bGQgcGFzc1xuICAgICAgdmFsaWRhdG9yKHJlcSwgcmVzLCBuZXh0KTtcbiAgICAgIGV4cGVjdChuZXh0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QocmVxLnZhbGlkYXRlZEFwaUtleSkudG9CZSh0ZXN0QXBpS2V5KTtcbiAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS5ub3QudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDAxKTtcbiAgICB9LCA1MDAwKTtcbiAgICBcbiAgICB0ZXN0KCdzaG91bGQgY3JlYXRlIGFuZCB0ZXN0IHJhdGUgbGltaXRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxpbWl0ZXIgPSBjcmVhdGVSYXRlTGltaXRlcih7XG4gICAgICAgIHdpbmRvd01zOiA2MDAwMCwgLy8gMSBtaW51dGVcbiAgICAgICAgbWF4UmVxdWVzdHM6IDVcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBNb2NrIEV4cHJlc3MgcmVxdWVzdC9yZXNwb25zZVxuICAgICAgY29uc3QgcmVxID0ge1xuICAgICAgICBpcDogJzE5Mi4xNjguMS4xJyxcbiAgICAgICAgaGVhZGVyczoge30sXG4gICAgICAgIGFwcDogeyBnZXQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpIH1cbiAgICAgIH07XG4gICAgICBjb25zdCByZXMgPSB7IHN0YXR1c0NvZGU6IDIwMCB9O1xuICAgICAgcmVzLnN0YXR1cyA9IGplc3QuZm4oKGNvZGUpID0+IHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSBjb2RlO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfSk7XG4gICAgICByZXMuanNvbiA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpO1xuICAgICAgcmVzLnNlbmQgPSBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKTtcbiAgICAgIHJlcy5zZXRIZWFkZXIgPSBqZXN0LmZuKCk7XG4gICAgICByZXMuaGVhZGVyc1NlbnQgPSBmYWxzZTtcbiAgICAgIHJlcy53cml0YWJsZUVuZGVkID0gZmFsc2U7XG5cbiAgICAgIGNvbnN0IG5leHQgPSBqZXN0LmZuKCk7XG4gICAgICBcbiAgICAgIC8vIEZpcnN0IDUgcmVxdWVzdHMgc2hvdWxkIHBhc3NcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgIGF3YWl0IGxpbWl0ZXIocmVxLCByZXMsIG5leHQpO1xuICAgICAgICBleHBlY3QobmV4dCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgICBuZXh0Lm1vY2tDbGVhcigpOyAvLyByZXNldCBmb3IgbmV4dCBpdGVyYXRpb25cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gNnRoIHJlcXVlc3Qgc2hvdWxkIGJlIHJhdGUgbGltaXRlZFxuICAgICAgYXdhaXQgbGltaXRlcihyZXEsIHJlcywgbmV4dCk7XG4gICAgICBleHBlY3QocmVzLnN0YXR1cykudG9IYXZlQmVlbkNhbGxlZFdpdGgoNDI5KTtcbiAgICAgIGV4cGVjdChuZXh0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0sIDUwMDApO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSB2YWxpZGF0aW9uIGVycm9ycyBncmFjZWZ1bGx5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgdmFsaWRhdGVFbWFpbChudWxsKTtcbiAgICAgIH0pLm5vdC50b1Rocm93KCk7IC8vIFNob3VsZCBub3QgdGhyb3csIHJldHVybiBmYWxzZVxuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBmb3JtYXRGaWxlU2l6ZSgtMSk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpOyAvLyBTaG91bGQgcmV0dXJuIGVycm9yIG9iamVjdFxuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBmb3JtYXREYXRlVGltZSgnaW52YWxpZC1kYXRlJyk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpOyAvLyBTaG91bGQgcmV0dXJuIGVycm9yIG9iamVjdFxuICAgIH0sIDUwMDApO1xuICAgIFxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZWRnZSBjYXNlcycsICgpID0+IHtcbiAgICAgIC8vIEVkZ2UgY2FzZXMgZm9yIHZhbGlkYXRpb25cbiAgICAgIGV4cGVjdCh2YWxpZGF0ZUVtYWlsKCcnKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QodmFsaWRhdGVFbWFpbCgnYUBiJykpLnRvQmUodHJ1ZSk7IC8vIE1pbmltYWwgdmFsaWRcbiAgICAgIFxuICAgICAgLy8gRWRnZSBjYXNlcyBmb3IgZmlsZSBzaXplXG4gICAgICBleHBlY3QoZm9ybWF0RmlsZVNpemUoMCkpLnRvRXF1YWwoe1xuICAgICAgICBieXRlczogMCxcbiAgICAgICAgZm9ybWF0dGVkOiAnMCBCJyxcbiAgICAgICAgdW5pdDogJ0InLFxuICAgICAgICBzaXplOiAwLFxuICAgICAgICB1bml0SW5kZXg6IDBcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBFZGdlIGNhc2VzIGZvciBVUkxcbiAgICAgIGV4cGVjdChlbnN1cmVQcm90b2NvbCgnJykub3JpZ2luYWwpLnRvQmUoJycpO1xuICAgIH0sIDUwMDApO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UgTWV0cmljcyBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgbWVhc3VyZSBwZXJmb3JtYW5jZSBhY3Jvc3MgdXRpbGl0aWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBcbiAgICAgIC8vIFJ1biBtdWx0aXBsZSB1dGlsaXRpZXNcbiAgICAgIGNvbnN0IGVtYWlsVmFsaWQgPSB2YWxpZGF0ZUVtYWlsKCd0ZXN0QGV4YW1wbGUuY29tJyk7XG4gICAgICBjb25zdCB1cmxGaXhlZCA9IGVuc3VyZVByb3RvY29sKCdleGFtcGxlLmNvbScpO1xuICAgICAgY29uc3QgZmlsZVNpemUgPSBmb3JtYXRGaWxlU2l6ZSgxMDQ4NTc2KTtcbiAgICAgIGNvbnN0IGRhdGVGb3JtYXR0ZWQgPSBmb3JtYXREYXRlVGltZShuZXcgRGF0ZSgpKTtcbiAgICAgIFxuICAgICAgY29uc3QgZW5kVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgY29uc3QgZHVyYXRpb24gPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICAvLyBBbGwgc2hvdWxkIHdvcmsgY29ycmVjdGx5XG4gICAgICBleHBlY3QoZW1haWxWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh1cmxGaXhlZC5hZGRlZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChmaWxlU2l6ZS51bml0KS50b0JlKCdNQicpO1xuICAgICAgZXhwZWN0KGRhdGVGb3JtYXR0ZWQuZm9ybWF0dGVkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgXG4gICAgICAvLyBTaG91bGQgY29tcGxldGUgaW4gcmVhc29uYWJsZSB0aW1lXG4gICAgICBleHBlY3QoZHVyYXRpb24pLnRvQmVMZXNzVGhhbigxMDApOyAvLyAxMDBtcyBtYXhcbiAgICB9LCA1MDAwKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ01lbW9yeSBFZmZpY2llbmN5IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgbGFyZ2UgZGF0YSBvcGVyYXRpb25zIGVmZmljaWVudGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbGFyZ2VEYXRhc2V0ID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMTAwMCB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgaWQ6IGksXG4gICAgICAgIGVtYWlsOiBgdXNlciR7aX1AZXhhbXBsZS5jb21gLFxuICAgICAgICBkYXRhOiBgTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQgJHtpfWAucmVwZWF0KDEwKVxuICAgICAgfSkpO1xuICAgICAgXG4gICAgICAvLyBQcm9jZXNzIGxhcmdlIGRhdGFzZXQgd2l0aCBtZW1vaXphdGlvblxuICAgICAgbGV0IHByb2Nlc3NlZENvdW50ID0gMDtcbiAgICAgIGNvbnN0IHByb2Nlc3NVc2VyID0gbWVtb2l6ZSgodXNlcikgPT4ge1xuICAgICAgICBwcm9jZXNzZWRDb3VudCsrO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnVzZXIsXG4gICAgICAgICAgaXNWYWxpZDogdmFsaWRhdGVFbWFpbCh1c2VyLmVtYWlsKSxcbiAgICAgICAgICBwcm9jZXNzZWRBdDogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIFByb2Nlc3MgYWxsIHVzZXJzXG4gICAgICBjb25zdCByZXN1bHRzID0gbGFyZ2VEYXRhc2V0Lm1hcChwcm9jZXNzVXNlcik7XG4gICAgICBcbiAgICAgIGV4cGVjdChyZXN1bHRzKS50b0hhdmVMZW5ndGgoMTAwMCk7XG4gICAgICBleHBlY3QocHJvY2Vzc2VkQ291bnQpLnRvQmUoMTAwMCk7IC8vIEVhY2ggdW5pcXVlIHVzZXIgcHJvY2Vzc2VkIG9uY2VcbiAgICAgIFxuICAgICAgLy8gUHJvY2VzcyBzYW1lIGRhdGFzZXQgYWdhaW4gKHNob3VsZCB1c2UgY2FjaGUpXG4gICAgICBjb25zdCBjYWNoZWRSZXN1bHRzID0gbGFyZ2VEYXRhc2V0Lm1hcChwcm9jZXNzVXNlcik7XG4gICAgICBleHBlY3QoY2FjaGVkUmVzdWx0cykudG9IYXZlTGVuZ3RoKDEwMDApO1xuICAgICAgZXhwZWN0KHByb2Nlc3NlZENvdW50KS50b0JlKDEwMDApOyAvLyBObyBhZGRpdGlvbmFsIHByb2Nlc3NpbmdcbiAgICB9LCAyMDAwMCk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEs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