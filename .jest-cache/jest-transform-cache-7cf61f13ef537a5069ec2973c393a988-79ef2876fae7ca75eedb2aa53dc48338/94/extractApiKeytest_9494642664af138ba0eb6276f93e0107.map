{"version":3,"names":["default","extractApiKey","require","describe","it","req","headers","authorization","expect","toBe","query","api_key","body","checkBody","toBeNull","headerNames","token","queryParam","authPrefix","undefined","secret","bodyField"],"sources":["extractApiKey.test.js"],"sourcesContent":["const { default: extractApiKey } = require('./extractApiKey');\n\ndescribe('extractApiKey', () => {\n  it('should extract from Authorization Bearer header', () => {\n    const req = { headers: { authorization: 'Bearer my-secret-key' } };\n    expect(extractApiKey(req)).toBe('my-secret-key');\n  });\n\n  it('should extract from x-api-key header', () => {\n    const req = { headers: { 'x-api-key': 'header-key-123' } };\n    expect(extractApiKey(req)).toBe('header-key-123');\n  });\n\n  it('should extract from api-key header', () => {\n    const req = { headers: { 'api-key': 'alt-header-key' } };\n    expect(extractApiKey(req)).toBe('alt-header-key');\n  });\n\n  it('should extract from query parameter', () => {\n    const req = { headers: {}, query: { api_key: 'query-key-456' } };\n    expect(extractApiKey(req)).toBe('query-key-456');\n  });\n\n  it('should extract from body when enabled', () => {\n    const req = { headers: {}, query: {}, body: { api_key: 'body-key-789' } };\n    expect(extractApiKey(req, { checkBody: true })).toBe('body-key-789');\n  });\n\n  it('should not extract from body when disabled', () => {\n    const req = { headers: {}, query: {}, body: { api_key: 'body-key-789' } };\n    expect(extractApiKey(req)).toBeNull();\n  });\n\n  it('should prioritize Authorization header over other sources', () => {\n    const req = {\n      headers: { authorization: 'Bearer bearer-key', 'x-api-key': 'header-key' },\n      query: { api_key: 'query-key' }\n    };\n    expect(extractApiKey(req)).toBe('bearer-key');\n  });\n\n  it('should prioritize headers over query params', () => {\n    const req = { headers: { 'x-api-key': 'header-key' }, query: { api_key: 'query-key' } };\n    expect(extractApiKey(req)).toBe('header-key');\n  });\n\n  it('should respect custom header names', () => {\n    const req = { headers: { 'my-custom-key': 'custom-value' } };\n    expect(extractApiKey(req, { headerNames: ['my-custom-key'] })).toBe('custom-value');\n  });\n\n  it('should respect custom query param name', () => {\n    const req = { headers: {}, query: { token: 'token-value' } };\n    expect(extractApiKey(req, { queryParam: 'token' })).toBe('token-value');\n  });\n\n  it('should respect custom auth prefix', () => {\n    const req = { headers: { authorization: 'ApiKey secret123' } };\n    expect(extractApiKey(req, { authPrefix: 'ApiKey ' })).toBe('secret123');\n  });\n\n  it('should trim whitespace from extracted keys', () => {\n    const req = { headers: { 'x-api-key': '  spaced-key  ' } };\n    expect(extractApiKey(req)).toBe('spaced-key');\n  });\n\n  it('should return null for missing key', () => {\n    expect(extractApiKey({ headers: {}, query: {} })).toBeNull();\n    expect(extractApiKey({ headers: {} })).toBeNull();\n    expect(extractApiKey({})).toBeNull();\n  });\n\n  it('should return null for invalid request object', () => {\n    expect(extractApiKey(null)).toBeNull();\n    expect(extractApiKey(undefined)).toBeNull();\n    expect(extractApiKey('string')).toBeNull();\n  });\n\n  it('should handle empty Authorization header after prefix', () => {\n    const req = { headers: { authorization: 'Bearer ' } };\n    expect(extractApiKey(req)).toBeNull();\n  });\n\n  it('should handle custom body field', () => {\n    const req = { headers: {}, query: {}, body: { secret: 'body-secret' } };\n    expect(extractApiKey(req, { checkBody: true, bodyField: 'secret' })).toBe('body-secret');\n  });\n});\n"],"mappings":"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","ignoreList":[]}