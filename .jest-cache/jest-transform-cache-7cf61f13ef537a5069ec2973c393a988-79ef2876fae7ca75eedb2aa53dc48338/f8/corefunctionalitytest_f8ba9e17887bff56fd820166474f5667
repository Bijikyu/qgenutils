437d7cd37a94018cd31e7098bde29c9f
/**
 * Integration Tests for QGenUtils Core Functionality
 * 
 * Tests real-world usage scenarios and integration between utilities
 */

// Import utilities individually to avoid ES module issues
import { validateEmail } from '../../lib/utilities/validation/validateEmail.js';
import { hashPassword } from '../../lib/utilities/password/hashPassword.js';
import { verifyPassword } from '../../lib/utilities/password/verifyPassword.js';
import { memoize } from '../../lib/utilities/performance/memoize.js';
import { debounce } from '../../lib/utilities/performance/debounce.js';
import { formatDateTime } from '../../lib/utilities/datetime/formatDateTime.js';
import { ensureProtocol } from '../../lib/utilities/url/ensureProtocol.js';
import { formatFileSize } from '../../lib/utilities/file/formatFileSize.js';
import { createApiKeyValidator } from '../../lib/utilities/middleware/createApiKeyValidator.js';
import { createRateLimiter } from '../../lib/utilities/middleware/createRateLimiter.js';
describe('QGenUtils Integration Tests', () => {
  describe('Security Integration', () => {
    it('should validate email format', () => {
      const result = validateEmail('user@example.com');
      expect(result).toBe(true);
    });
    it('should hash and verify passwords', async () => {
      const {
        hash,
        salt
      } = await hashPassword('testPassword123!');
      const isValid = await verifyPassword('testPassword123!', hash, salt);
      expect(isValid).toBe(true);
    });
  });
  describe('Performance Integration', () => {
    it('should memoize expensive functions', () => {
      let callCount = 0;
      const expensiveFn = n => {
        callCount++;
        return n * 2;
      };
      const memoizedFn = memoize(expensiveFn);

      // First call should execute function
      expect(memoizedFn(5)).toBe(10);
      expect(callCount).toBe(1);

      // Second call should use cache
      expect(memoizedFn(5)).toBe(10);
      expect(callCount).toBe(1);
    });
    it('should debounce function calls', done => {
      let callCount = 0;
      const debouncedFn = debounce(() => {
        callCount++;
      }, 100);
      debouncedFn();
      debouncedFn();

      // Should only call once due to debouncing
      setTimeout(() => {
        expect(callCount).toBe(1);
        done();
      }, 150);
    });
  });
  describe('Utility Integration', () => {
    it('should format date time properly', () => {
      const result = formatDateTime('2023-12-25T10:30:00.000Z');
      expect(result).toHaveProperty('formatted');
      expect(typeof result.formatted).toBe('string');
    });
    it('should ensure protocol in URLs', () => {
      const result = ensureProtocol('example.com');
      expect(result).toHaveProperty('processed');
      expect(result.processed).toBe('https://example.com');
    });
    it('should format file sizes', () => {
      const result = formatFileSize(1024);
      expect(result).toBe('1.00 KB');
    });
  });
  describe('Middleware Integration', () => {
    it('should create API key validator', () => {
      const validator = createApiKeyValidator({
        headerName: 'X-API-Key',
        required: true
      });
      expect(typeof validator).toBe('function');
    });
    it('should create rate limiter', () => {
      const limiter = createRateLimiter({
        windowMs: 60000,
        max: 100
      });
      expect(typeof limiter).toBe('function');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2YWxpZGF0ZUVtYWlsIiwiaGFzaFBhc3N3b3JkIiwidmVyaWZ5UGFzc3dvcmQiLCJtZW1vaXplIiwiZGVib3VuY2UiLCJmb3JtYXREYXRlVGltZSIsImVuc3VyZVByb3RvY29sIiwiZm9ybWF0RmlsZVNpemUiLCJjcmVhdGVBcGlLZXlWYWxpZGF0b3IiLCJjcmVhdGVSYXRlTGltaXRlciIsImRlc2NyaWJlIiwiaXQiLCJyZXN1bHQiLCJleHBlY3QiLCJ0b0JlIiwiaGFzaCIsInNhbHQiLCJpc1ZhbGlkIiwiY2FsbENvdW50IiwiZXhwZW5zaXZlRm4iLCJuIiwibWVtb2l6ZWRGbiIsImRvbmUiLCJkZWJvdW5jZWRGbiIsInNldFRpbWVvdXQiLCJ0b0hhdmVQcm9wZXJ0eSIsImZvcm1hdHRlZCIsInByb2Nlc3NlZCIsInZhbGlkYXRvciIsImhlYWRlck5hbWUiLCJyZXF1aXJlZCIsImxpbWl0ZXIiLCJ3aW5kb3dNcyIsIm1heCJdLCJzb3VyY2VzIjpbImNvcmUtZnVuY3Rpb25hbGl0eS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW50ZWdyYXRpb24gVGVzdHMgZm9yIFFHZW5VdGlscyBDb3JlIEZ1bmN0aW9uYWxpdHlcbiAqIFxuICogVGVzdHMgcmVhbC13b3JsZCB1c2FnZSBzY2VuYXJpb3MgYW5kIGludGVncmF0aW9uIGJldHdlZW4gdXRpbGl0aWVzXG4gKi9cblxuLy8gSW1wb3J0IHV0aWxpdGllcyBpbmRpdmlkdWFsbHkgdG8gYXZvaWQgRVMgbW9kdWxlIGlzc3Vlc1xuaW1wb3J0IHsgdmFsaWRhdGVFbWFpbCB9IGZyb20gJy4uLy4uL2xpYi91dGlsaXRpZXMvdmFsaWRhdGlvbi92YWxpZGF0ZUVtYWlsLmpzJztcbmltcG9ydCB7IGhhc2hQYXNzd29yZCB9IGZyb20gJy4uLy4uL2xpYi91dGlsaXRpZXMvcGFzc3dvcmQvaGFzaFBhc3N3b3JkLmpzJztcbmltcG9ydCB7IHZlcmlmeVBhc3N3b3JkIH0gZnJvbSAnLi4vLi4vbGliL3V0aWxpdGllcy9wYXNzd29yZC92ZXJpZnlQYXNzd29yZC5qcyc7XG5pbXBvcnQgeyBtZW1vaXplIH0gZnJvbSAnLi4vLi4vbGliL3V0aWxpdGllcy9wZXJmb3JtYW5jZS9tZW1vaXplLmpzJztcbmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSAnLi4vLi4vbGliL3V0aWxpdGllcy9wZXJmb3JtYW5jZS9kZWJvdW5jZS5qcyc7XG5pbXBvcnQgeyBmb3JtYXREYXRlVGltZSB9IGZyb20gJy4uLy4uL2xpYi91dGlsaXRpZXMvZGF0ZXRpbWUvZm9ybWF0RGF0ZVRpbWUuanMnO1xuaW1wb3J0IHsgZW5zdXJlUHJvdG9jb2wgfSBmcm9tICcuLi8uLi9saWIvdXRpbGl0aWVzL3VybC9lbnN1cmVQcm90b2NvbC5qcyc7XG5pbXBvcnQgeyBmb3JtYXRGaWxlU2l6ZSB9IGZyb20gJy4uLy4uL2xpYi91dGlsaXRpZXMvZmlsZS9mb3JtYXRGaWxlU2l6ZS5qcyc7XG5pbXBvcnQgeyBjcmVhdGVBcGlLZXlWYWxpZGF0b3IgfSBmcm9tICcuLi8uLi9saWIvdXRpbGl0aWVzL21pZGRsZXdhcmUvY3JlYXRlQXBpS2V5VmFsaWRhdG9yLmpzJztcbmltcG9ydCB7IGNyZWF0ZVJhdGVMaW1pdGVyIH0gZnJvbSAnLi4vLi4vbGliL3V0aWxpdGllcy9taWRkbGV3YXJlL2NyZWF0ZVJhdGVMaW1pdGVyLmpzJztcblxuZGVzY3JpYmUoJ1FHZW5VdGlscyBJbnRlZ3JhdGlvbiBUZXN0cycsICgpID0+IHtcbiAgZGVzY3JpYmUoJ1NlY3VyaXR5IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgZW1haWwgZm9ybWF0JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVFbWFpbCgndXNlckBleGFtcGxlLmNvbScpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFzaCBhbmQgdmVyaWZ5IHBhc3N3b3JkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgaGFzaCwgc2FsdCB9ID0gYXdhaXQgaGFzaFBhc3N3b3JkKCd0ZXN0UGFzc3dvcmQxMjMhJyk7XG4gICAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgdmVyaWZ5UGFzc3dvcmQoJ3Rlc3RQYXNzd29yZDEyMyEnLCBoYXNoLCBzYWx0KTtcbiAgICAgIGV4cGVjdChpc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBtZW1vaXplIGV4cGVuc2l2ZSBmdW5jdGlvbnMnLCAoKSA9PiB7XG4gICAgICBsZXQgY2FsbENvdW50ID0gMDtcbiAgICAgIGNvbnN0IGV4cGVuc2l2ZUZuID0gKG4pID0+IHtcbiAgICAgICAgY2FsbENvdW50Kys7XG4gICAgICAgIHJldHVybiBuICogMjtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IG1lbW9pemVkRm4gPSBtZW1vaXplKGV4cGVuc2l2ZUZuKTtcbiAgICAgIFxuICAgICAgLy8gRmlyc3QgY2FsbCBzaG91bGQgZXhlY3V0ZSBmdW5jdGlvblxuICAgICAgZXhwZWN0KG1lbW9pemVkRm4oNSkpLnRvQmUoMTApO1xuICAgICAgZXhwZWN0KGNhbGxDb3VudCkudG9CZSgxKTtcbiAgICAgIFxuICAgICAgLy8gU2Vjb25kIGNhbGwgc2hvdWxkIHVzZSBjYWNoZVxuICAgICAgZXhwZWN0KG1lbW9pemVkRm4oNSkpLnRvQmUoMTApO1xuICAgICAgZXhwZWN0KGNhbGxDb3VudCkudG9CZSgxKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGVib3VuY2UgZnVuY3Rpb24gY2FsbHMnLCAoZG9uZSkgPT4ge1xuICAgICAgbGV0IGNhbGxDb3VudCA9IDA7XG4gICAgICBjb25zdCBkZWJvdW5jZWRGbiA9IGRlYm91bmNlKCgpID0+IHtcbiAgICAgICAgY2FsbENvdW50Kys7XG4gICAgICB9LCAxMDApO1xuICAgICAgXG4gICAgICBkZWJvdW5jZWRGbigpO1xuICAgICAgZGVib3VuY2VkRm4oKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIG9ubHkgY2FsbCBvbmNlIGR1ZSB0byBkZWJvdW5jaW5nXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZXhwZWN0KGNhbGxDb3VudCkudG9CZSgxKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSwgMTUwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1V0aWxpdHkgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgZGF0ZSB0aW1lIHByb3Blcmx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gZm9ybWF0RGF0ZVRpbWUoJzIwMjMtMTItMjVUMTA6MzA6MDAuMDAwWicpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2Zvcm1hdHRlZCcpO1xuICAgICAgZXhwZWN0KHR5cGVvZiByZXN1bHQuZm9ybWF0dGVkKS50b0JlKCdzdHJpbmcnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW5zdXJlIHByb3RvY29sIGluIFVSTHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBlbnN1cmVQcm90b2NvbCgnZXhhbXBsZS5jb20nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdwcm9jZXNzZWQnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucHJvY2Vzc2VkKS50b0JlKCdodHRwczovL2V4YW1wbGUuY29tJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBmaWxlIHNpemVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gZm9ybWF0RmlsZVNpemUoMTAyNCk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKCcxLjAwIEtCJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNaWRkbGV3YXJlIEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIEFQSSBrZXkgdmFsaWRhdG9yJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmFsaWRhdG9yID0gY3JlYXRlQXBpS2V5VmFsaWRhdG9yKHtcbiAgICAgICAgaGVhZGVyTmFtZTogJ1gtQVBJLUtleScsXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHR5cGVvZiB2YWxpZGF0b3IpLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSByYXRlIGxpbWl0ZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBsaW1pdGVyID0gY3JlYXRlUmF0ZUxpbWl0ZXIoe1xuICAgICAgICB3aW5kb3dNczogNjAwMDAsXG4gICAgICAgIG1heDogMTAwXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHR5cGVvZiBsaW1pdGVyKS50b0JlKCdmdW5jdGlvbicpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVNBLGFBQWEsUUFBUSxpREFBaUQ7QUFDL0UsU0FBU0MsWUFBWSxRQUFRLDhDQUE4QztBQUMzRSxTQUFTQyxjQUFjLFFBQVEsZ0RBQWdEO0FBQy9FLFNBQVNDLE9BQU8sUUFBUSw0Q0FBNEM7QUFDcEUsU0FBU0MsUUFBUSxRQUFRLDZDQUE2QztBQUN0RSxTQUFTQyxjQUFjLFFBQVEsZ0RBQWdEO0FBQy9FLFNBQVNDLGNBQWMsUUFBUSwyQ0FBMkM7QUFDMUUsU0FBU0MsY0FBYyxRQUFRLDRDQUE0QztBQUMzRSxTQUFTQyxxQkFBcUIsUUFBUSx5REFBeUQ7QUFDL0YsU0FBU0MsaUJBQWlCLFFBQVEscURBQXFEO0FBRXZGQyxRQUFRLENBQUMsNkJBQTZCLEVBQUUsTUFBTTtFQUM1Q0EsUUFBUSxDQUFDLHNCQUFzQixFQUFFLE1BQU07SUFDckNDLEVBQUUsQ0FBQyw4QkFBOEIsRUFBRSxNQUFNO01BQ3ZDLE1BQU1DLE1BQU0sR0FBR1osYUFBYSxDQUFDLGtCQUFrQixDQUFDO01BQ2hEYSxNQUFNLENBQUNELE1BQU0sQ0FBQyxDQUFDRSxJQUFJLENBQUMsSUFBSSxDQUFDO0lBQzNCLENBQUMsQ0FBQztJQUVGSCxFQUFFLENBQUMsa0NBQWtDLEVBQUUsWUFBWTtNQUNqRCxNQUFNO1FBQUVJLElBQUk7UUFBRUM7TUFBSyxDQUFDLEdBQUcsTUFBTWYsWUFBWSxDQUFDLGtCQUFrQixDQUFDO01BQzdELE1BQU1nQixPQUFPLEdBQUcsTUFBTWYsY0FBYyxDQUFDLGtCQUFrQixFQUFFYSxJQUFJLEVBQUVDLElBQUksQ0FBQztNQUNwRUgsTUFBTSxDQUFDSSxPQUFPLENBQUMsQ0FBQ0gsSUFBSSxDQUFDLElBQUksQ0FBQztJQUM1QixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRkosUUFBUSxDQUFDLHlCQUF5QixFQUFFLE1BQU07SUFDeENDLEVBQUUsQ0FBQyxvQ0FBb0MsRUFBRSxNQUFNO01BQzdDLElBQUlPLFNBQVMsR0FBRyxDQUFDO01BQ2pCLE1BQU1DLFdBQVcsR0FBSUMsQ0FBQyxJQUFLO1FBQ3pCRixTQUFTLEVBQUU7UUFDWCxPQUFPRSxDQUFDLEdBQUcsQ0FBQztNQUNkLENBQUM7TUFFRCxNQUFNQyxVQUFVLEdBQUdsQixPQUFPLENBQUNnQixXQUFXLENBQUM7O01BRXZDO01BQ0FOLE1BQU0sQ0FBQ1EsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUNQLElBQUksQ0FBQyxFQUFFLENBQUM7TUFDOUJELE1BQU0sQ0FBQ0ssU0FBUyxDQUFDLENBQUNKLElBQUksQ0FBQyxDQUFDLENBQUM7O01BRXpCO01BQ0FELE1BQU0sQ0FBQ1EsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUNQLElBQUksQ0FBQyxFQUFFLENBQUM7TUFDOUJELE1BQU0sQ0FBQ0ssU0FBUyxDQUFDLENBQUNKLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDM0IsQ0FBQyxDQUFDO0lBRUZILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBR1csSUFBSSxJQUFLO01BQzdDLElBQUlKLFNBQVMsR0FBRyxDQUFDO01BQ2pCLE1BQU1LLFdBQVcsR0FBR25CLFFBQVEsQ0FBQyxNQUFNO1FBQ2pDYyxTQUFTLEVBQUU7TUFDYixDQUFDLEVBQUUsR0FBRyxDQUFDO01BRVBLLFdBQVcsQ0FBQyxDQUFDO01BQ2JBLFdBQVcsQ0FBQyxDQUFDOztNQUViO01BQ0FDLFVBQVUsQ0FBQyxNQUFNO1FBQ2ZYLE1BQU0sQ0FBQ0ssU0FBUyxDQUFDLENBQUNKLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDekJRLElBQUksQ0FBQyxDQUFDO01BQ1IsQ0FBQyxFQUFFLEdBQUcsQ0FBQztJQUNULENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztFQUVGWixRQUFRLENBQUMscUJBQXFCLEVBQUUsTUFBTTtJQUNwQ0MsRUFBRSxDQUFDLGtDQUFrQyxFQUFFLE1BQU07TUFDM0MsTUFBTUMsTUFBTSxHQUFHUCxjQUFjLENBQUMsMEJBQTBCLENBQUM7TUFDekRRLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDLENBQUNhLGNBQWMsQ0FBQyxXQUFXLENBQUM7TUFDMUNaLE1BQU0sQ0FBQyxPQUFPRCxNQUFNLENBQUNjLFNBQVMsQ0FBQyxDQUFDWixJQUFJLENBQUMsUUFBUSxDQUFDO0lBQ2hELENBQUMsQ0FBQztJQUVGSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsTUFBTTtNQUN6QyxNQUFNQyxNQUFNLEdBQUdOLGNBQWMsQ0FBQyxhQUFhLENBQUM7TUFDNUNPLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDLENBQUNhLGNBQWMsQ0FBQyxXQUFXLENBQUM7TUFDMUNaLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDZSxTQUFTLENBQUMsQ0FBQ2IsSUFBSSxDQUFDLHFCQUFxQixDQUFDO0lBQ3RELENBQUMsQ0FBQztJQUVGSCxFQUFFLENBQUMsMEJBQTBCLEVBQUUsTUFBTTtNQUNuQyxNQUFNQyxNQUFNLEdBQUdMLGNBQWMsQ0FBQyxJQUFJLENBQUM7TUFDbkNNLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDLENBQUNFLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDaEMsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUZKLFFBQVEsQ0FBQyx3QkFBd0IsRUFBRSxNQUFNO0lBQ3ZDQyxFQUFFLENBQUMsaUNBQWlDLEVBQUUsTUFBTTtNQUMxQyxNQUFNaUIsU0FBUyxHQUFHcEIscUJBQXFCLENBQUM7UUFDdENxQixVQUFVLEVBQUUsV0FBVztRQUN2QkMsUUFBUSxFQUFFO01BQ1osQ0FBQyxDQUFDO01BRUZqQixNQUFNLENBQUMsT0FBT2UsU0FBUyxDQUFDLENBQUNkLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDM0MsQ0FBQyxDQUFDO0lBRUZILEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxNQUFNO01BQ3JDLE1BQU1vQixPQUFPLEdBQUd0QixpQkFBaUIsQ0FBQztRQUNoQ3VCLFFBQVEsRUFBRSxLQUFLO1FBQ2ZDLEdBQUcsRUFBRTtNQUNQLENBQUMsQ0FBQztNQUVGcEIsTUFBTSxDQUFDLE9BQU9rQixPQUFPLENBQUMsQ0FBQ2pCLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDekMsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119