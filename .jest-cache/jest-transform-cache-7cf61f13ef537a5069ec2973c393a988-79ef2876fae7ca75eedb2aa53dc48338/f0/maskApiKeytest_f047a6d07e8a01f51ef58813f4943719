f3ce02c24eee4837f29317c83eb747f7
const {
  default: maskApiKey
} = require('./maskApiKey');
describe('maskApiKey', () => {
  it('should mask API key showing first 4 chars by default', () => {
    expect(maskApiKey('sk_live_abc123xyz')).toBe('sk_l***');
    expect(maskApiKey('abcdefghij')).toBe('abcd***');
  });
  it('should respect custom visible chars count', () => {
    expect(maskApiKey('sk_live_abc123', 7)).toBe('sk_live***');
    expect(maskApiKey('abcdefghij', 2)).toBe('ab***');
  });
  it('should handle short keys by masking entirely', () => {
    expect(maskApiKey('abc', 4)).toBe('***');
    expect(maskApiKey('ab', 4)).toBe('***');
    expect(maskApiKey('a')).toBe('***');
  });
  it('should handle empty or invalid input', () => {
    expect(maskApiKey('')).toBe('***');
    expect(maskApiKey(null)).toBe('***');
    expect(maskApiKey(undefined)).toBe('***');
    expect(maskApiKey(12345)).toBe('***');
  });
  it('should handle exactly visible chars length', () => {
    expect(maskApiKey('abcd', 4)).toBe('***');
    expect(maskApiKey('abcde', 4)).toBe('abcd***');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkZWZhdWx0IiwibWFza0FwaUtleSIsInJlcXVpcmUiLCJkZXNjcmliZSIsIml0IiwiZXhwZWN0IiwidG9CZSIsInVuZGVmaW5lZCJdLCJzb3VyY2VzIjpbIm1hc2tBcGlLZXkudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IGRlZmF1bHQ6IG1hc2tBcGlLZXkgfSA9IHJlcXVpcmUoJy4vbWFza0FwaUtleScpO1xuXG5kZXNjcmliZSgnbWFza0FwaUtleScsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCBtYXNrIEFQSSBrZXkgc2hvd2luZyBmaXJzdCA0IGNoYXJzIGJ5IGRlZmF1bHQnLCAoKSA9PiB7XG4gICAgZXhwZWN0KG1hc2tBcGlLZXkoJ3NrX2xpdmVfYWJjMTIzeHl6JykpLnRvQmUoJ3NrX2wqKionKTtcbiAgICBleHBlY3QobWFza0FwaUtleSgnYWJjZGVmZ2hpaicpKS50b0JlKCdhYmNkKioqJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmVzcGVjdCBjdXN0b20gdmlzaWJsZSBjaGFycyBjb3VudCcsICgpID0+IHtcbiAgICBleHBlY3QobWFza0FwaUtleSgnc2tfbGl2ZV9hYmMxMjMnLCA3KSkudG9CZSgnc2tfbGl2ZSoqKicpO1xuICAgIGV4cGVjdChtYXNrQXBpS2V5KCdhYmNkZWZnaGlqJywgMikpLnRvQmUoJ2FiKioqJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaGFuZGxlIHNob3J0IGtleXMgYnkgbWFza2luZyBlbnRpcmVseScsICgpID0+IHtcbiAgICBleHBlY3QobWFza0FwaUtleSgnYWJjJywgNCkpLnRvQmUoJyoqKicpO1xuICAgIGV4cGVjdChtYXNrQXBpS2V5KCdhYicsIDQpKS50b0JlKCcqKionKTtcbiAgICBleHBlY3QobWFza0FwaUtleSgnYScpKS50b0JlKCcqKionKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgb3IgaW52YWxpZCBpbnB1dCcsICgpID0+IHtcbiAgICBleHBlY3QobWFza0FwaUtleSgnJykpLnRvQmUoJyoqKicpO1xuICAgIGV4cGVjdChtYXNrQXBpS2V5KG51bGwpKS50b0JlKCcqKionKTtcbiAgICBleHBlY3QobWFza0FwaUtleSh1bmRlZmluZWQpKS50b0JlKCcqKionKTtcbiAgICBleHBlY3QobWFza0FwaUtleSgxMjM0NSkpLnRvQmUoJyoqKicpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGhhbmRsZSBleGFjdGx5IHZpc2libGUgY2hhcnMgbGVuZ3RoJywgKCkgPT4ge1xuICAgIGV4cGVjdChtYXNrQXBpS2V5KCdhYmNkJywgNCkpLnRvQmUoJyoqKicpO1xuICAgIGV4cGVjdChtYXNrQXBpS2V5KCdhYmNkZScsIDQpKS50b0JlKCdhYmNkKioqJyk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFBRUEsT0FBTyxFQUFFQztBQUFXLENBQUMsR0FBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUV2REMsUUFBUSxDQUFDLFlBQVksRUFBRSxNQUFNO0VBQzNCQyxFQUFFLENBQUMsc0RBQXNELEVBQUUsTUFBTTtJQUMvREMsTUFBTSxDQUFDSixVQUFVLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDSyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQ3ZERCxNQUFNLENBQUNKLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDSyxJQUFJLENBQUMsU0FBUyxDQUFDO0VBQ2xELENBQUMsQ0FBQztFQUVGRixFQUFFLENBQUMsMkNBQTJDLEVBQUUsTUFBTTtJQUNwREMsTUFBTSxDQUFDSixVQUFVLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQ0ssSUFBSSxDQUFDLFlBQVksQ0FBQztJQUMxREQsTUFBTSxDQUFDSixVQUFVLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUNLLElBQUksQ0FBQyxPQUFPLENBQUM7RUFDbkQsQ0FBQyxDQUFDO0VBRUZGLEVBQUUsQ0FBQyw4Q0FBOEMsRUFBRSxNQUFNO0lBQ3ZEQyxNQUFNLENBQUNKLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQ0ssSUFBSSxDQUFDLEtBQUssQ0FBQztJQUN4Q0QsTUFBTSxDQUFDSixVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUNLLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDdkNELE1BQU0sQ0FBQ0osVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUNLLElBQUksQ0FBQyxLQUFLLENBQUM7RUFDckMsQ0FBQyxDQUFDO0VBRUZGLEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxNQUFNO0lBQy9DQyxNQUFNLENBQUNKLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDSyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ2xDRCxNQUFNLENBQUNKLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDSyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3BDRCxNQUFNLENBQUNKLFVBQVUsQ0FBQ00sU0FBUyxDQUFDLENBQUMsQ0FBQ0QsSUFBSSxDQUFDLEtBQUssQ0FBQztJQUN6Q0QsTUFBTSxDQUFDSixVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQ0ssSUFBSSxDQUFDLEtBQUssQ0FBQztFQUN2QyxDQUFDLENBQUM7RUFFRkYsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLE1BQU07SUFDckRDLE1BQU0sQ0FBQ0osVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDSyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3pDRCxNQUFNLENBQUNKLFVBQVUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQ0ssSUFBSSxDQUFDLFNBQVMsQ0FBQztFQUNoRCxDQUFDLENBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=